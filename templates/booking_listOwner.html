{% extends "navbarOwner.html" %}

{% block head %}
<title>Booking List</title>
<style>
    table {
        width: 80%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 16px;
        text-align: left;
    }
    table th, table td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    table th {
        background-color: #f2f2f2;
        font-weight: bold;
    }
    .btn {
        padding: 5px 10px;
        margin: 5px;
        border: none;
        cursor: pointer;
    }
    .btn-primary { background-color: #4CAF50; color: white; }
    .btn-disabled { background-color: #ccc; color: white; cursor: not-allowed; }

    .flash-messages {
        margin: 20px 0;
    }

    .alert {
        padding: 15px;
        margin-bottom: 20px;
        border: 1px solid transparent;
        border-radius: 4px;
        font-size: 1.1em;
        text-align: center;
    }

    .alert-success {
        color: #155724;
        background-color: #d4edda;
        border-color: #c3e6cb;
    }

    .alert-danger {
        color: #721c24;
        background-color: #f8d7da;
        border-color: #f5c6cb;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .alert {
        animation: fadeIn 0.5s ease-in-out;
    }
</style>
{% endblock %}

{% block body %}
<h2>Daftar Booking</h2>
<form method="GET" action="{{ url_for('booking_listOwner') }}">
    <div>
        <label for="nik">Cari NIK:</label>
        <input type="text" id="nik" name="nik" placeholder="Masukkan NIK" value="{{ request.args.get('nik', '') }}">
    </div>
    <div>
        <label for="tanggal">Cari Tanggal (YYYY-MM-DD):</label>
        <input type="date" id="tanggal" name="tanggal" value="{{ request.args.get('tanggal', '') }}">
    </div>
    <button type="submit" class="btn btn-primary">Cari</button>
</form>


<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
  <div class="flash-messages">
    {% for category, message in messages %}
      <div class="alert alert-{{ category }}">
        {{ message }}
      </div>
    {% endfor %}
  </div>
{% endif %}
{% endwith %}

<table>
    <thead>
        <tr>
            <th>ID Booking</th>
            <th>NIK</th>
            <th>Nama Pelanggan</th>
            <th>ID Petugas</th>
            <th>Kode Kamar</th>
            <th>Waktu Checkin</th>
            <th>Durasi (Hari)</th>
            <th>Waktu Checkout</th>
            <th>Denda</th>
            <th>Harga Final</th>
            <th>Aksi</th>
        </tr>
    </thead>
    <tbody>
        {% for booking in bookings %}
        <tr>
            <td>{{ booking.id_booking }}</td>
            <td>{{ booking.nik }}</td>
            <td>{{ booking.nama_pelanggan }}</td>
            <td>{{ booking.id_petugas }}</td>
            <td>{{ booking.kode_kamar }}</td>
            <td>{{ booking.waktu_checkin }}</td>
            <td>{{ booking.durasi_hari }}</td>
            <td>{{ booking.waktu_checkout if booking.waktu_checkout else "Belum Checkout" }}</td>
            <td>{{ booking.denda if booking.denda is not none else "-" }}</td>
            <td>{{ booking.harga_final if booking.harga_final is not none else "-" }}</td>
            <td>
                {% if not booking.waktu_checkout %}
                <form method="POST">
                    <input type="hidden" name="booking_id" value="{{ booking.id_booking }}">
                    <button type="submit" class="btn btn-primary">Checkout</button>
                </form>
                {% else %}
                <button class="btn btn-disabled">Sudah Checkout</button>
                <button class="btn btn-primary">Cetak Struk</button>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
